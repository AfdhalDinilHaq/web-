<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mood Motivator - Gen Z Edition</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');

:root{
  --bg-deep: #0f1016;
  --card: rgba(35, 36, 47, 0.7);
  --text: #e8e8e8;
  --accent: #8be8c9;
  --transition: .3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  
  --color-senang: #ffeb3b;
  --color-sedih: #03a9f4;
  --color-stres: #ff4081;
  --color-malas: #8bc34a;
  --current-glow: rgba(139, 232, 201, 0.15);
}

body.light{
  --bg-deep: #f3f6fa;
  --card: rgba(255, 255, 255, 0.8);
  --text: #1f1f1f;
}

*{box-sizing:border-box}

body{
  font-family: 'Poppins', sans-serif;
  background-color: var(--bg-deep);
  color: var(--text);
  margin: 0; 
  min-height: 100vh;
  display: flex; 
  flex-direction: column; 
  align-items: center;
  transition: background-color 0.5s;
  /* PERUBAHAN DISINI: Agar bisa di-scroll secara vertikal */
  overflow-x: hidden;
  overflow-y: auto; 
}

/* Background & Cursor Glow */
#canvas-bg { position: fixed; top: 0; left: 0; z-index: -1; pointer-events: none; }
.cursor-glow {
  position: fixed; width: 350px; height: 350px;
  background: radial-gradient(circle, var(--current-glow) 0%, transparent 70%);
  border-radius: 50%; pointer-events: none;
  transform: translate(-50%, -50%); z-index: 0;
  transition: background 0.5s;
}

.toggle-wrapper { position: fixed; top: 20px; left: 20px; z-index: 10; }
.capture-wrapper { position: fixed; top: 20px; right: 20px; z-index: 10; }

.toggle {
  width: 60px; height: 30px; border-radius: 50px;
  background: var(--card); border: 1px solid rgba(255,255,255,0.1);
  position: relative; cursor: pointer;
}
.toggle::after { content: "üåô"; position: absolute; left: 5px; top: 2px; transition: .3s; font-size: 14px; }
body.light .toggle::after { content: "‚òÄÔ∏è"; left: 32px; }

main{ 
  flex: 1; 
  max-width: 600px; 
  width: 100%; 
  padding: 80px 20px; 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  z-index: 1; 
  /* PERUBAHAN DISINI: Memastikan konten tidak terpotong */
  overflow: visible; 
}

/* Avatar Animations */
#avatar{
  width: 110px; height: 110px;
  background: var(--card); border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 55px; margin-bottom: 25px;
  backdrop-filter: blur(10px);
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.jump { animation: jumpAnim 0.6s ease; }
@keyframes jumpAnim { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-30px) scale(1.1); } }

.shrink-grow { animation: shrinkGrowAnim 0.8s ease; }
@keyframes shrinkGrowAnim { 0% { transform: scale(2); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

.shake { animation: shakeAnim 0.4s ease; }
@keyframes shakeAnim { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px) rotate(-5deg); } 75% { transform: translateX(10px) rotate(5deg); } }

.fade-in { animation: fadeInAnim 1s ease; }
@keyframes fadeInAnim { 0% { filter: blur(10px); opacity: 0; } 100% { filter: blur(0); opacity: 1; } }

#energy-bar{ width: 220px; height: 8px; background: rgba(255,255,255,0.1); border-radius: 10px; margin-bottom: 40px; overflow: hidden; }
#energy-fill{ height: 100%; width: 0%; background: linear-gradient(90deg, #8be8c9, #c8b9ff); transition: .5s ease; }

/* Buttons */
.mood-buttons{ display: flex; gap: 12px; flex-wrap: wrap; justify-content: center; }
.mood-btn {
  background: var(--card); color: var(--text); border: 1px solid rgba(255,255,255,0.1);
  padding: 12px 24px; border-radius: 50px; cursor: pointer; font-weight: 500;
  transition: var(--transition); backdrop-filter: blur(5px);
}
.mood-btn:hover { transform: scale(1.1); }

.btn-senang:hover { border-color: var(--color-senang); box-shadow: 0 0 20px var(--color-senang); }
.btn-sedih:hover { border-color: var(--color-sedih); box-shadow: 0 0 20px var(--color-sedih); }
.btn-stres:hover { border-color: var(--color-stres); box-shadow: 0 0 20px var(--color-stres); }
.btn-malas:hover { border-color: var(--color-malas); box-shadow: 0 0 20px var(--color-malas); }
.btn-gabut:hover {
  background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #8b00ff);
  background-size: 400%; animation: rainbow 3s linear infinite; color: white; border: none;
}
@keyframes rainbow { 0%{background-position:0%} 100%{background-position:400%} }

/* UI Boxes */
#motivation{ margin-top: 30px; padding: 20px; border-radius: 15px; background: var(--card); width: 100%; text-align: center; opacity: 0; transition: .4s; }
#motivation.show{ opacity: 1; transform: translateY(0); }

#stress-helper, #manifest-input, #gabut-tools, #vibe-box { display: none; margin-top: 20px; width: 100%; text-align: center; }

#breathing-circle {
    width: 60px; height: 60px; border: 4px solid var(--color-stres); border-radius: 50%;
    margin: 15px auto; animation: breath 4s infinite ease-in-out;
}
@keyframes breath { 0%, 100% { transform: scale(1); opacity: 0.5; } 50% { transform: scale(2.2); opacity: 1; } }

#manifestText {
    background: rgba(255,255,255,0.05); border: 1px solid var(--accent); color: white;
    padding: 12px; border-radius: 12px; width: 85%; outline: none; margin-bottom: 10px; font-family: inherit;
}

.tool-btn { padding: 10px 18px; border-radius: 12px; border: none; background: var(--accent); color: #12131a; cursor: pointer; font-weight: 600; margin: 5px; transition: 0.3s; }
.tool-btn:hover { filter: brightness(1.2); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }

/* Vibe Check Button Styling */
.vibe-btn {
    background: #ff79c6 !important;
    color: white !important;
    box-shadow: 0 0 15px rgba(255, 121, 198, 0.4);
    animation: pulseGlow 2s infinite;
}
@keyframes pulseGlow { 0% { box-shadow: 0 0 5px rgba(255, 121, 198, 0.4); } 50% { box-shadow: 0 0 20px rgba(255, 121, 198, 0.8); } 100% { box-shadow: 0 0 5px rgba(255, 121, 198, 0.4); } }

/* Manifestation Flying Text */
.manifest-fly {
    position: fixed; color: var(--accent); white-space: nowrap; pointer-events: none;
    font-size: 22px; font-weight: 600; text-shadow: 0 0 12px rgba(139, 232, 201, 0.6);
    animation: flyOut 12s linear forwards; z-index: 5;
}
@keyframes flyOut {
    0% { transform: translate(-100%, 0) rotate(0deg); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { transform: translate(100vw, -120vh) rotate(360deg); opacity: 0; }
}

/* Tambahkan di dalam tag <style> */
.vibe-btn {
    background: #f4a460 !important; /* Warna cokelat kue */
    color: #5d2e0a !important;
    border: 2px solid #d2691e !important;
    font-weight: bold;
}

#vibe-text {
    transition: opacity 0.5s ease, transform 0.5s ease;
}

.shake-anim {
    animation: cookieShake 0.4s ease;
}

@keyframes cookieShake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px) rotate(-2deg); }
    75% { transform: translateX(5px) rotate(2deg); }
}

#mute-btn {
    transition: all 0.3s ease;
}

/* Tambahkan class ini lewat JS jika ingin tombol berubah warna saat mute */
.muted-active {
    background: rgba(255, 0, 0, 0.2) !important;
    border-color: #ff4081 !important;
}

footer{ padding: 30px; font-size: 12px; opacity: 0.5; }
</style>
</head>
<body>

<canvas id="canvas-bg"></canvas>
<div class="cursor-glow" id="glow"></div>

<div class="toggle-wrapper">
  <div class="toggle" onclick="toggleMode()"></div>
</div>

<div class="capture-wrapper">
    <button onclick="captureMode()" class="tool-btn" style="background:rgba(255,255,255,0.1); color:var(--text); border:1px solid rgba(255,255,255,0.2);">üì∏ Capture</button>
</div>

<div class="sound-toggle-wrapper" style="position: fixed; top: 20px; right: 140px; z-index: 10;">
    <button onclick="toggleSound()" class="tool-btn" id="mute-btn" style="background:rgba(255,255,255,0.1); color:var(--text); border:1px solid rgba(255,255,255,0.2);">üîä</button>
</div>


<main>
  <h1>Gimana mood kamu hari ini?</h1>
  <div id="avatar">üôÇ</div>
  <div id="energy-bar"><div id="energy-fill"></div></div>

  <div class="mood-buttons">
    <button class="mood-btn btn-senang" onclick="pickMood('senang','üòÑ', 'jump')">Senang</button>
    <button class="mood-btn btn-sedih" onclick="pickMood('sedih','ü•≤', 'shrink-grow')">Sedih</button>
    <button class="mood-btn btn-stres" onclick="pickMood('stres','üòµ‚Äçüí´', 'shake')">Stres</button>
    <button class="mood-btn btn-malas" onclick="pickMood('malas','üò™', 'fade-in')">Malas</button>
    <button class="mood-btn btn-gabut" onclick="pickMood('gabut','ü§®', 'jump')">Gabut</button>
  </div>

  <div id="motivation"></div>

  <div id="stress-helper">
    <div id="breathing-circle"></div>
    <p style="font-size: 14px;">Tarik Napas... Tahan... Buang...</p>
  </div>

  <div id="manifest-input">
    <input type="text" id="manifestText" placeholder="Tulis manifestasimu agar melayang...">
    <br>
    <button onclick="sendManifest()" class="tool-btn">Manifestasikan! ‚ú®</button>
  </div>

  <div id="vibe-box">
    <button onclick="getVibeCheck()" class="tool-btn vibe-btn">Fortune Cookies ü•†‚ú®</button>
    <p id="vibe-text" style="font-style: italic; margin-top: 15px; color: #ff79c6; min-height: 24px; font-weight: 500;"></p>
  </div>

  <div id="gabut-tools">
    <button class="tool-btn" onclick="discoMode()">Mode Disko üï∫</button>
    <button class="tool-btn" onclick="spawnEmojiSuper()">Ledakan Emoji! üí•</button>
  </div>
</main>

<footer>¬© Mood Motivator | Gen Z Edition</footer>

<script>
/* --- 1. CONFIGURATION & ASSETS --- */
const sounds = {
    senang: new Audio('https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3'),
    sedih: new Audio('https://assets.mixkit.co/active_storage/sfx/123/123-preview.mp3'),
    stres: new Audio('https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3'),
    malas: new Audio('https://assets.mixkit.co/active_storage/sfx/1003/1003-preview.mp3'),
    gabut: new Audio('https://assets.mixkit.co/active_storage/sfx/2004/2004-preview.mp3'),
    fortune: new Audio('https://assets.mixkit.co/active_storage/sfx/2017/2017-preview.mp3'),
    manifest: new Audio('https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3'),
    disco: new Audio('https://assets.mixkit.co/active_storage/sfx/2001/2001-preview.mp3'),
};

const explosionSounds = [
    new Audio('https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3'),
    new Audio('https://assets.mixkit.co/active_storage/sfx/2578/2578-preview.mp3'),
    new Audio('https://assets.mixkit.co/active_storage/sfx/2579/2579-preview.mp3')
];

const quotes = { 
    senang: [
        "Main Character energy! Terus bersinar ya! ‚ú®",
        "Vibes kamu hari ini nular ke orang lain, keren! üåà",
        "Jangan lupa rayakan kemenangan kecilmu hari ini! ü•Ç",
        "Senyummu itu aset paling mahal, pakai terus! üíé"
    ], 
    sedih: [
        "Gak apa-apa sedih, esok pasti lebih cerah. ü´Ç",
        "Peluk jauh buat kamu. Take your time ya. ü§ç",
        "Awan mendung gak akan selamanya ada di langitmu. ‚òÅÔ∏è",
        "Menangis bukan berarti lemah, itu tanda kamu manusia. üíß"
    ],
    stres: [
        "Tarik napas.. kamu lebih kuat dari masalahmu. üí™",
        "Gak semua harus selesai hari ini, istirahat dulu. üõë",
        "Kamu sudah berusaha hebat, bangga sama dirimu! ‚≠ê"
    ],
    malas: [
        "Rebahan bentar buat cas energi, tapi jangan kebablasan! üîã",
        "Mager itu manusiawi, nikmati waktu tenangmu. üõå"
    ],
    gabut: [
        "Waktu kosong adalah peluang buat hal baru! üí°",
        "Semesta lagi dengerin, coba manifestasi sesuatu! üß†"
    ]
};

const vibes = [
  "Saran hari ini: Gak usah CO keranjang malam ini, sayang duitnya! üõí",
  "Semesta bilang: Ada chat yang bikin senyum minggu depan. üëÄ",
  "Status Jodoh: Lagi di jalan, cuma kejebak macet total. Sabar ya! üõµ",
  "Mood hari ini: Butuh es kopi tapi takut asam lambung. üßã",
  "Manifestasimu lagi diproses kurir semesta, tungguin aja! üì¶",
  "Vibe Check: Kamu lagi cakep banget hari ini, jangan lupa ngaca! ‚ú®",
  "Status: Lagi cakep banget, jangan lupa ngaca! ‚ú®", 
  "Saran: Stop scroll TikTok, mending jajan es kopi. üßã", 
  "Vibe hari ini: Main Character energy! üíÖ", 
  "Gak usah CO keranjang malam ini, sayang duitnya. üõí", 
  "Semesta bilang: Kamu butuh liburan, bukan revisi. üèñÔ∏è", 
  "Mood: Butuh seblak level 5 buat bertahan hidup. ü•µ", 
  "Status Jodoh: Masih di tangan Tuhan, belum di tanganmu. üõµ", 
  "Vibe: Lagi pengen menghilang dari peradaban. ‚úàÔ∏è", 
  "Jangan terlalu baik, inget kamu bukan takjil. üåô",
  "Dompet: Kritis. Semangat: Minimalis. Gaya: Maksimalis. üí∏", 
  "Hari ini kamu cantik, tapi bohong. Gak ding, beneran! ‚ù§Ô∏è",
  "Stop overthinking, nanti kerutan nambah. üß†", 
  "Vibe: Butuh tidur 3 hari 3 malam. üõå", 
  "Rating hari ini: 10/10 kalau kamu gak mager. üìà", 
  "Lagi mode 'Iya-in aja biar cepet'. ü´†", 
  "Asmara: Lagi di-ghosting semesta. üëª", 
  "Lagi nunggu chat yang gak kunjung dateng. üëÄ", 
  "Jangan lupa minum air putih, biar gak halu mikirin dia. üíß", 
  "Vibe: Pingin kaya tapi gak mau kerja. ü§ë", 
  "Status: Mencoba tetap waras di tengah gempuran tugas. üòµ‚Äçüí´", 
  "Semesta bilang: Ada chat yang bikin senyum besok pagi! üíå", 
  "Manifestasi hari ini: Rekening tiba-tiba nambah nol-nya. üí∞", 
  "Hoki kamu hari ini: 99.9%! Gas terus! üî•", 
  "Ada orang diem-diem lagi stalking profil kamu. üïµÔ∏è", 
  "Minggu ini bakal ada kabar baik yang gak disangka. üéÅ", 
  "Manifestasi: Apapun yang kamu mau, bakal 'Sat Set'! ‚ú®", 
  "Vibe: Magnet uang dan keberuntungan. üß≤", 
  "Karma baik lagi nyari jalan buat nemuin kamu. üçÄ", 
  "Doi sebentar lagi sadar kalau kamu berharga. üíé",
  "Kesabaranmu bakal dibayar tuntas bulan ini! ‚è≥", 
  "Mood: Pingin es krim tapi takut radang. üç¶", 
  "Status: Low battery mental, butuh healing. ü™´", 
  "Vibe: Gabut yang sangat produktif (tidur). üò¥", 
  "Lagi nunggu weekend padahal masih hari Senin. üóìÔ∏è", 
  "Isi kepala: 10% Masa depan, 90% lirik lagu random. üé∂", 
  "Gak usah mandi, kamu udah wangi kok dari jauh. üå∏", 
  "Lagi tahap sayang ke diri sendiri dulu. üßò", 
  "Status: Jomblo elite, trauma sulit. üõ°Ô∏è", 
  "Mood: Butuh yang manis-manis, selain janji dia. üç≠",
  "Vibe: Chill aja, dunia gak bakal kiamat cuma karena typo. ‚úåÔ∏è", 
  "Kamu hebat sudah bertahan sejauh ini. Bangga banget! üëè", 
  "Pelan-pelan aja, yang penting jalan terus. üö∂", 
  "Dunia butuh versi kamu yang paling bahagia. üòä", 
  "Gak apa-apa capek, besok mulai lagi ya. üîã", 
  "Your potential is limitless, jangan dengerin haters! üöÄ", 
  "Satu langkah kecil hari ini lebih baik dari nol. üë£", 
  "Stay hydrated and stay humble! ü•§", 
  "Mimpi besar butuh istirahat yang cukup juga. üåô", 
  "Everything will make sense soon. Sabar ya! üåà", 
  "You are enough. Always have been. üíñ", 
  "Vibes: Lagi pengen dimanja tapi gak ada pawangnya. ü•∫",
  "Kurangi ekspektasi, perbanyak apresiasi diri. ‚ú®", 
  "Hari ini bakal ada diskon makanan buat kamu! üçï", 
  "Lagi di tahap 'apa aja ayo' asal jangan kerja. üèÉ", 
  "Visual: Sempurna. Dompet: Berdoa. ü§≤", 
  "Self reward-nya jangan kebablasan, inget cicilan. üí≥", 
  "Ada kejutan di balik kejadian yang bikin kesel tadi. üéÅ", 
  "Kamu itu limited edition, jangan minder! ü¶Ñ", 
  "Vibe: Aura-aura dapet uang kaget. üí∏", 
  "Jangan lupa senyum, biar yang benci makin panas. üî•", 
  "Mood: Pengen jajan terus tapi pengen kurus. ü•®", 
  "Dunia lagi baik, mintalah apa saja hari ini. üåå", 
  "Status asmara: Belum ada hilalnya. üî≠", 
  "Fokus ke diri sendiri, yang lain cuma penonton. üé≠", 
  "Manifestasi: Minggu depan full healing tanpa pusing. üçÄ", 
  "Vibe: Lagi pengen dengerin lagu galau tapi lagi seneng. üéß", 
  "Kamu lebih kuat dari yang kamu bayangkan. üí™", 
  "Hari ini cocok buat memulai hal baru! üöÄ", 
  "Status: Sibuk memperbaiki masa depan. üõ†Ô∏è", 
  "Jangan bandingin hidupmu sama feed IG orang. üì±", 
  "Vibe: Menunggu libur nasional berikutnya. üìÖ", 
  "Lagi butuh asupan vitamin Sea. üåä",
  "Saran: Tidur siang 15 menit biar gak emosi. üò¥",
  "Hari ini aura keberuntunganmu warna emas! üü°", 
  "Keep shining, dunia butuh cahayamu! üåü",
  "Status: Mencari jati diri di tumpukan tugas. üìÇ", 
  "Vibe: Butuh pelukan, tapi pelukan kasur juga oke. üõå", 
  "Jangan dengerin omongan orang yang gak kasih makan kamu. ü§´",
  "Manifestasi: Besok bangun-bangun glowing! ‚ú®", 
  "Vibe: Lagi pengen ngopi sambil liatin hujan. ‚òï", 
  "Hati-hati, hari ini ada yang kangen kamu berat. üíì", 
  "Mood: Lagi gak bisa diganggu gugat. üö´", 
  "Stay cool, drama-drama mah lewat aja. üòé",
  "Vibe: Siap menaklukkan dunia setelah makan siang. üç±", 
  "Kamu itu berharga, jangan biarin satu orang bikin drop. üíé",
  "Status: Lagi pengen jadi beban keluarga bentar aja. üë∂", 
  "Manifestasi: Segala urusan dimudahkan hari ini! ‚úÖ", 
  "Vibe: Aura positif terpancar nyata! üåà",
  "Jangan lupa bahagia, minimal hari ini aja dulu. üòÅ",
  "Lagi di mode hemat energi buat masa depan. üîã", 
  "Mood: Butuh divalidasi kalau aku itu pinter. üß†", 
  "Vibe: Menanti notifikasi transferan masuk. üì≤", 
  "Apapun yang kamu takutin, ternyata gak seserem itu. ü¶Å",
  "Status: Masih memantau, belum mau bertindak. üßê", 
  "Vibe: Pengen jadi awan aja, tinggal terbang. ‚òÅÔ∏è",
  "Hari ini kamu berhak dapet self-care maksimal! üíÜ",
  "Manifestasi: Jodoh mendekat, utang menjauh. üèπ",
  "Status: Lagi nunggu hilal kebahagiaan. üåô",
  "Vibe: Chill, heal, and still real. üßò", 
  "You did well today, istirahat ya! üåô"
];

/* --- 2. GLOBAL STATES --- */
let currentSound = null;
let isMuted = false;
let lastQuote = "";

/* --- 3. AUDIO SYSTEM --- */
function playSfx(name) {
    if (currentSound) {
        currentSound.pause();
        currentSound.currentTime = 0;
    }
    if (isMuted || !sounds[name]) return;
    currentSound = sounds[name];
    currentSound.play().catch(e => console.log("Audio play blocked"));
}

function toggleSound() {
    isMuted = !isMuted;
    const btn = document.getElementById('mute-btn');
    btn.textContent = isMuted ? "üîá" : "üîä";
    if (isMuted && currentSound) {
        currentSound.pause();
    }
}

/* --- 4. VISUALS (NEURAL BG) --- */
const canvas = document.getElementById('canvas-bg');
const ctx = canvas.getContext('2d');
let particles = [];
const mouse = { x: null, y: null };

window.addEventListener('mousemove', (e) => {
    mouse.x = e.clientX; mouse.y = e.clientY;
    const glow = document.getElementById('glow');
    glow.style.left = e.clientX + 'px';
    glow.style.top = e.clientY + 'px';
});

function init() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    particles = [];
    for(let i=0; i<85; i++) {
        particles.push({
            x: Math.random()*canvas.width, y: Math.random()*canvas.height,
            sx: (Math.random()-0.5)*1.2, sy: (Math.random()-0.5)*1.2
        });
    }
}

function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const color = document.body.classList.contains('light') ? 'rgba(0,0,0,0.1)' : 'rgba(255,255,255,0.08)';
    particles.forEach((p, i) => {
        p.x += p.sx; p.y += p.sy;
        if(p.x<0||p.x>canvas.width) p.sx*=-1;
        if(p.y<0||p.y>canvas.height) p.sy*=-1;
        ctx.fillStyle = color;
        ctx.beginPath(); ctx.arc(p.x, p.y, 1.5, 0, Math.PI*2); ctx.fill();
        for(let j=i; j<particles.length; j++) {
            const d = Math.hypot(p.x-particles[j].x, p.y-particles[j].y);
            if(d<110) {
                const md = Math.hypot(p.x-mouse.x, p.y-mouse.y);
                ctx.strokeStyle = (md < 150) ? 'rgba(139, 232, 201, 0.3)' : color;
                ctx.lineWidth = 0.5; ctx.beginPath(); ctx.moveTo(p.x, p.y);
                ctx.lineTo(particles[j].x, particles[j].y); ctx.stroke();
            }
        }
    });
    requestAnimationFrame(draw);
}
window.addEventListener('resize', init);
init(); draw();

/* --- 5. CORE LOGIC --- */
function pickMood(mood, emoji, animClass) {
    playSfx(mood);
    const a = document.getElementById("avatar");
    a.textContent = emoji;
    a.className = ""; 
    void a.offsetWidth; 
    a.classList.add(animClass);

    const glowColors = { 
        senang: 'rgba(255, 235, 59, 0.3)', 
        sedih: 'rgba(3, 169, 244, 0.3)', 
        stres: 'rgba(255, 64, 129, 0.3)', 
        malas: 'rgba(139, 195, 74, 0.3)', 
        gabut: 'rgba(255, 255, 255, 0.3)' 
    };
    document.body.style.setProperty('--current-glow', glowColors[mood]);

    updateEnergy(mood);
    showQuote(mood);

    // Toggle Helpers
    document.getElementById('stress-helper').style.display = (mood === 'stres') ? 'block' : 'none';
    const isGabut = (mood === 'gabut');
    ['manifest-input', 'gabut-tools', 'vibe-box'].forEach(id => {
        document.getElementById(id).style.display = isGabut ? 'block' : 'none';
    });
}

function updateEnergy(mood) {
    const e = { senang: 98, sedih: 15, stres: 40, malas: 5, gabut: 55 };
    document.getElementById("energy-fill").style.width = (e[mood] || 50) + "%";
}

function showQuote(mood) {
    const box = document.getElementById("motivation");
    const listMood = quotes[mood];
    if(!listMood) return;

    let selectedQuote;
    do {
        selectedQuote = listMood[Math.floor(Math.random() * listMood.length)];
    } while (selectedQuote === lastQuote && listMood.length > 1);

    lastQuote = selectedQuote;
    box.classList.remove("show");
    setTimeout(() => { 
        box.textContent = selectedQuote; 
        box.classList.add("show"); 
    }, 200);
}

function toggleMode() { document.body.classList.toggle("light"); }

/* --- 6. GABUT FEATURES --- */
function sendManifest() {
    const input = document.getElementById('manifestText');
    if(!input.value) return;
    playSfx('manifest'); 

    const el = document.createElement("div");
    el.className = "manifest-fly";
    el.textContent = input.value;
    el.style.top = (Math.random() * 60 + 20) + "vh";
    el.style.left = "0px";
    document.body.appendChild(el);
    
    input.value = "";
    spawnEmojiVisualOnly(20); 
    setTimeout(() => el.remove(), 12000);
}

function getVibeCheck() {
    playSfx('fortune');
    const btn = document.querySelector('.vibe-btn');
    const text = document.getElementById('vibe-text');
    
    btn.classList.add('shake-anim');
    setTimeout(() => btn.classList.remove('shake-anim'), 400);

    const random = vibes[Math.floor(Math.random() * vibes.length)];
    text.style.opacity = 0;
    setTimeout(() => {
        text.textContent = "ü•†: " + random;
        text.style.opacity = 1;
    }, 200);
}

function discoMode() {
    playSfx('disco'); 
    let c = 0;
    const interval = setInterval(() => {
        document.body.style.backgroundColor = `hsl(${Math.random()*360}, 60%, 20%)`;
        if(c++ > 30) { 
            clearInterval(interval); 
            document.body.style.backgroundColor = ""; 
        }
    }, 100);
}

function spawnEmojiSuper() {
    // Tombol Bom Emoji memicu suara letupan kecil
    spawnEmojiVisualOnly(100, true);
}

function spawnEmojiVisualOnly(count, allowPopSounds = false) {
    const emojis = ["üî•","‚ú®","üåà","ü•µ","üöÄ","üíñ","ü´†","üéâ","üå∏","ü¶ã","üíé","üçÄ","üéà","üåü"];
    for(let i=0; i<count; i++) {
        setTimeout(() => {
            if (allowPopSounds && i % 10 === 0 && !isMuted) {
                const randomPop = explosionSounds[Math.floor(Math.random() * explosionSounds.length)];
                randomPop.currentTime = 0;
                randomPop.volume = 0.2;
                randomPop.play().catch(() => {});
            }

            const el = document.createElement("div");
            el.style.position = "fixed";
            el.style.left = Math.random() * 100 + "vw";
            el.style.bottom = "-50px";
            el.style.fontSize = (Math.random() * 30 + 20) + "px";
            el.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            el.style.zIndex = "100";
            el.style.pointerEvents = "none";
            
            const duration = Math.random() * 3 + 2;
            el.style.transition = `all ${duration}s cubic-bezier(0.1, 0.5, 0.3, 1)`;
            document.body.appendChild(el);
            
            requestAnimationFrame(() => {
                el.style.transform = `translate(${(Math.random() - 0.5) * 500}px, -125vh) rotate(${Math.random() * 1000}deg)`;
                el.style.opacity = "0";
            });
            setTimeout(() => el.remove(), duration * 1000);
        }, i * 15);
    }
}

function captureMode() {
    const elementsToHide = [
        document.querySelector('.mood-buttons'),
        document.querySelector('footer'),
        document.querySelector('.toggle-wrapper'),
        document.querySelector('.capture-wrapper'),
        document.querySelector('.sound-toggle-wrapper'),
        document.getElementById('stress-helper'),
        document.getElementById('manifest-input'),
        document.getElementById('gabut-tools'),
        document.getElementById('vibe-box')
    ];

    // Gunakan kurung kurawal untuk logika IF
    elementsToHide.forEach(el => {
        if(el) el.style.visibility = 'hidden';
    });

    alert("üì∏ Capture Mode Aktif! Screenshot sekarang. Kembali normal dalam 7 detik.");
    
    setTimeout(() => {
        elementsToHide.forEach(el => {
            if(el) el.style.visibility = 'visible';
        });
    }, 7000);
}
</script>
</body>
</html>